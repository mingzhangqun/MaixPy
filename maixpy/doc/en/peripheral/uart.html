<!DOCTYPE html>

<html lang="en"  class="">


<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="keywords" content="">
    
    
    <meta name="description" content="">
    
    <meta name="generator" content="teedoc">
    <meta name="theme" content="teedoc-plugin-theme-default">
    
        
        <meta name="markdown-generator" content="teedoc-plugin-markdown-parser">
        
        <script>
MathJax = {"loader": {"load": ["output/svg"]}, "tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]]}, "svg": {"fontCache": "global"}};
</script>
        
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        
        <script src="/maixpy/static/js/theme_default/pre_main.js"></script>
        
        <link rel="stylesheet" href="/maixpy/static/css/theme_default/prism.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/maixpy/static/css/theme_default/viewer.min.css" type="text/css"/>
        
        <link rel="stylesheet" href="/maixpy/static/css/theme_default/dark.css" type="text/css"/>
        
        <link rel="stylesheet" href="/maixpy/static/css/theme_default/light.css" type="text/css"/>
        
        <script src="/maixpy/static/js/theme_default/jquery.min.js"></script>
        
        <script src="/maixpy/static/js/theme_default/split.js"></script>
        
        <link rel="stylesheet" href="/maixpy/static/css/search/style.css" type="text/css"/>
        
        <link rel="stylesheet" href="/maixpy/static/css/custom.css" type="text/css"/>
        
    
    
    <title>MaixPy</title>
    
    <script type="text/javascript">js_vars = {}</script>
    <script type="text/javascript">metadata = {"tags": [], "date": null, "update": [], "ts": 0, "author": "", "brief": "", "cover": ""}</script>
</head>


<body class="type_doc">
    
    <div id="navbar">
        <div id="navbar_menu">
            <a class="site_title" href="/maixpy/en/">
                
                
                    <h2>MaixPy</h2>
                
        </a>
            <a id="navbar_menu_btn"></a>
        </div>
        <div id="navbar_items">
            <div>
                <ul id="nav_left">
<li class=""><a  href="https://wiki.sipeed.com">Sipeed Wiki</a></li>
<li class="active"><a  href="/maixpy/doc/en/index.html">Documentation</a></li>
<li class=""><a  href="/maixpy/api/index.html">API</a></li>
<li class=""><a  href="/maixpy/doc/en/faq.html">FAQ</a></li>
</ul>

            </div>
            <div>
                <ul id="nav_right">
<li class=""><a target="_blank" href="https://github.com/sipeed/maixpy"><img src='/maixpy/static/image/github-fill.svg' style='height: 1.5em;vertical-align: middle;'>&nbsp;</a></li>
<li class="sub_items "><a  ><img src='/maixpy/static/image/language.svg' style='height: 1.5em;vertical-align: middle;'>&nbsp;English</a><ul><li class="active"><a  href="/maixpy/doc/en/peripheral/uart.html">English</a></li>
<li class=""><a  href="/maixpy/doc/zh/peripheral/uart.html">中文</a></li>
</ul></li>
</ul>

                <ul class="nav_plugins"><li><a id="themes" class="light"></a></li></ul><ul class="nav_plugins"><li><a id="search"><span class="icon"></span><span class="placeholder">Search</span>
                            <div id="search_hints">
                                <span id="search_input_hint">Keywords separated by space</span>
                                <span id="search_loading_hint">Loading, wait please ...</span>
                                <span id="search_download_err_hint">Download error, please check network and refresh again</span>
                                <span id="search_other_docs_result_hint">Result from other docs</span>
                                <span id="search_curr_doc_result_hint">Result from current doc</span>
                            </div></a></li></ul>
            </div>
        </div>
    </div>
    
    <div id="wrapper">
        <div id="sidebar_wrapper">
            <div id="sidebar">
                <div id="sidebar_title">
                    
                </div>
                <ul class="show">
<li class="not_active with_link"><a href="/maixpy/doc/en/index.html"><span class="label">Quick Start</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/faq.html"><span class="label">FAQ</span><span class=""></span></a></li>
<li class="not_active no_link"><a><span class="label">Base</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/os.html"><span class="label">Burning system</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/app_usage.html"><span class="label">App uses</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/maixpy_upgrade.html"><span class="label">Update MaixPy</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/maixvision.html"><span class="label">MaixVision uses</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/python.html"><span class="label">Python syntax</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/linux_basic.html"><span class="label">Linux fundamentals</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/python_pkgs.html"><span class="label">Add python packages</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/app.html"><span class="label">Apps development</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/auto_start.html"><span class="label">Auto start</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/basic/view_src_code.html"><span class="label">View API source code</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">Basic images and algorithms</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/display.html"><span class="label">Screen uses</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/camera.html"><span class="label">Camera uses</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/image_ops.html"><span class="label">Image control</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/touchscreen.html"><span class="label">Touch screen</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/find_blobs.html"><span class="label">Finding color blocks</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/line_tracking.html"><span class="label">Line tracking</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/qrcode.html"><span class="label">QRcode identity</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/apriltag.html"><span class="label">AprilTag identity</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/opencv.html"><span class="label">Use OpenCV</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">AI Vision</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/ai.html"><span class="label">AI vision knowledge</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/classify.html"><span class="label">AI object classify</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/yolov5.html"><span class="label">YOLOv5/v8 object detect</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/face_detection.html"><span class="label">Face detect and keypoints</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/face_recognition.html"><span class="label">Face recognition</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/body_key_points.html"><span class="label">Human critical point detection</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/self_learn_classifier.html"><span class="label">Self-learning classifier</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/self_learn_detector.html"><span class="label">Self-learning detector</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/object_track.html"><span class="label">Object tracking and counting</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/ocr.html"><span class="label">OCR</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/maixhub_train.html"><span class="label">MaixHub online AI training</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/customize_model_yolov5.html"><span class="label">Offline train YOLOv5 model</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/vision/customize_model_yolov8.html"><span class="label">Offline train YOLOv8 model</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/ai_model_converter/maixcam.html"><span class="label">ONNX model to MaixCAM's</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">AI audio</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/maixpy/doc/en/audio/record.html"><span class="label">Audio record</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/audio/play.html"><span class="label">Play audio</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/no_translate.html?ref=/doc/zh/audio/classifier.html&from=/doc/en/audio/classifier.html"><span class="label">AI voice classifier</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/no_translate.html?ref=/doc/zh/audio/keyword.html&from=/doc/en/audio/keyword.html"><span class="label">Keyword recognize</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/audio/recognize.html"><span class="label">Real-time voice recognize</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/no_translate.html?ref=/doc/zh/audio/synthesis.html&from=/doc/en/audio/synthesis.html"><span class="label">Speech synthesis</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">Video</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/maixpy/doc/en/video/record.html"><span class="label">Video record</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/no_translate.html?ref=/doc/zh/video/play.html&from=/doc/en/video/play.html"><span class="label">Play video</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/video/jpeg_streaming.html"><span class="label">JPEG stream</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/video/rtsp_streaming.html"><span class="label">RTSP stream</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/video/rtmp_streaming.html"><span class="label">RTMP stream</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">Network</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/maixpy/doc/en/network/network_settings.html"><span class="label">Network settings</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/network/http.html"><span class="label">http communication</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/network/socket.html"><span class="label">socket communication</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/network/websocket.html"><span class="label">websocket communication</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/network/flask.html"><span class="label">Flask Web server</span><span class=""></span></a></li>
</ul>
</li>
<li class="active_parent no_link"><a><span class="label">On-chip peripherals</span><span class="sub_indicator"></span></a><ul class="show">
<li class="not_active with_link"><a href="/maixpy/doc/en/peripheral/pinmap.html"><span class="label">PINMAP</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/peripheral/gpio.html"><span class="label">GPIO</span><span class=""></span></a></li>
<li class="active with_link"><a href="/maixpy/doc/en/peripheral/uart.html"><span class="label">UART</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/peripheral/i2c.html"><span class="label">I2C</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/peripheral/pwm.html"><span class="label">PWM</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/peripheral/spi.html"><span class="label">SPI</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/peripheral/wdt.html"><span class="label">WDT watchdog</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/peripheral/adc.html"><span class="label">ADC</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">Off-chip modules</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/maixpy/doc/en/modules/temp_humi.html"><span class="label">Temperature and humidity</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/modules/acc.html"><span class="label">Accelerometer</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/modules/tof.html"><span class="label">TOF</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/modules/thermal_cam.html"><span class="label">Thermal imaging</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">Porjects</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/maixpy/doc/en/projects/index.html"><span class="label">Intro & Collection</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/projects/line_tracking_robot.html"><span class="label">Line tracking robot</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/projects/face_tracking.html"><span class="label">Face tracking 2-axis gimbal</span><span class=""></span></a></li>
</ul>
</li>
<li class="not_active no_link"><a><span class="label">Advanced</span><span class="sub_indicator sub_indicator_collapsed"></span></a><ul class="">
<li class="not_active with_link"><a href="/maixpy/doc/en/source_code/contribute.html"><span class="label">Contribute</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/source_code/build.html"><span class="label">Build source code</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/source_code/faq.html"><span class="label">MaixPy Source FAQ</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/source_code/add_c_module.html"><span class="label">Write in C/C++</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/source_code/maixcdk.html"><span class="label">MaixCDK develop</span><span class=""></span></a></li>
<li class="not_active with_link"><a href="/maixpy/doc/en/pro/compile_os.html"><span class="label">Build firmware</span><span class=""></span></a></li>
</ul>
</li>
</ul>

            </div>
        </div>
        <div id="article">
            <div id="menu_wrapper">
                <div id="menu">
                </div>
            </div>
            <div id="content_wrapper">
                <div id="content_body">
                    <div id="article_head">
                        <div id="article_title">
                            
                            <h1></h1>
                            
                        </div>
                        <div id="article_tags">
                            <ul>
                            
                            </ul>
                        </div>
                        <div id="article_info">
                        <div id="article_info_left">
                            <span class="article_author">
                                
                            </span>
                            
                                <span class="article_date" title="Last modify date: 2024-07-04">
                                    2024-07-04
                                </span>
                            
                        </div>
                        <div id="article_info_right">
                            
                            <div id="source_link">
                                <a href="https://github.com/sipeed/MaixPy/blob/main/docs/doc/en/peripheral/uart.md" target="_blank">
                                    Edit this page
                                </a>
                            </div>
                            
                        </div>
                        </div>
                    </div>
                    <div id="article_tools">
                        <span></span>
                        <span id="toc_btn"></span>
                    </div>
                    <div id="update_history">
                        
                    </div>
                    <div id="article_content">
                        
                            <h2 id="Translation-to-English%3A">Translation to English:</h2>
<h2 id="title%3A-MaixPy-UART-Serial-Port-Usage-Introduction">title: MaixPy UART Serial Port Usage Introduction</h2>
<h2 id="Introduction-to-Serial-Ports">Introduction to Serial Ports</h2>
<p>A serial port is a method of communication that includes definitions of hardware and communication protocols.</p>
<ul>
<li>Hardware includes:<ul>
<li>3 pins: <code>GND</code>, <code>RX</code>, <code>TX</code>. The communication between two parties involves cross-connecting RX and TX, i.e., one's TX sends to the other's RX, and both parties' GNDs are connected.</li>
<li>Controller, usually internal within the chip, also known as UART peripheral, typically a chip has one or more UART controllers, each with corresponding pins.</li>
</ul>
</li>
<li>Communication Protocol: To enable smooth communication between both parties, a set of protocols is established, which includes commonly used parameters like baud rate, parity bits, etc. Baud rate is the most frequently used parameter.</li>
</ul>
<p>Using the board’s serial port, you can communicate data with other microcontrollers or SoCs, such as implementing human detection on MaixCAM and then sending the coordinates through the serial port to an STM32 microcontroller.</p>
<h2 id="Using-Serial-Ports-in-MaixPy">Using Serial Ports in MaixPy</h2>
<p>For MaixCAM, a serial port is defaulted from the USB port, which can be used directly by plugging in the accompanying Type-C adapter board. Alternatively, without an adapter board, you can use the <code>A16(TX)</code> and <code>A17(RX)</code> pins on the board directly, which are equivalent to the pins led out from the USB port.</p>
<p><strong>Note</strong> when using the USB-lead serial port on MaixCAM: the Type-C plug and unplug orientation can switch the <code>RX</code> and <code>TX</code> on the adapter board. So, if you find communication is not happening, it might be due to the RX and TX being reversed; try flipping the Type-C connector to see if communication normalizes. This is considered a design flaw, but generally, as frequent unplugging is not common, this can be adapted to.</p>
<p>Once both communicating boards are connected (communication between the two involves cross-connecting RX and TX, and both parties' GNDs are connected), you can use the software.</p>
<p>Using a serial port in MaixPy is simple:</p>

<pre class="language-python"><code class="language-python">from maix import uart

devices = uart.list_devices()

serial = uart.UART(devices[0], 115200)
serial.write_str(&quot;hello world&quot;)
print(&quot;received:&quot;, serial.read(timeout = 2000))
</code></pre>
<p>This lists all serial port devices in the system, then uses the first one, which is the one led out from the Type-C as mentioned above.</p>
<p>For more serial port APIs, see <a href="../../../api/maix/peripheral/uart.html"  >UART API Documentation</a>.</p>
<h2 id="Notes-on-using-the-MaixCAM-serial-port">Notes on using the MaixCAM serial port</h2>
<p>Some developers may ask: Why does the computer not show a serial port device after plugging in the USB?</p>
<p>A: Because the device's USB is a virtual USB network card by default, it has no serial port function. If you want to access the device's terminal, please use ssh to connect.</p>
<p>For MaixCAM, the <code>serial port 0</code> led out from the Type-C adapter board is directly connected to the <code>A16(TX)</code> and <code>A17(RX)</code> pins, which can be directly connected to the serial port pins of other devices such as microcontrollers;</p>
<p>If you want to communicate with a computer, you need to use a USB to serial port board (such as <a href="https://item.taobao.com/item.htm?spm=a1z10.5-c-s.w4002-24984936573.13.73cc59d6AkB9bS&amp;id=610365562537"  target="_blank">this</a>) to connect to the computer.</p>
<p>It should be noted that <strong>MaixCAM's <code>serial port 0</code> will print a part of the boot log when it is turned on</strong>, and the words <code>serial ready</code> will be printed after the startup is complete. If you need to communicate with the microcontroller, you need to discard this part of the information. If there is a problem with the system startup, you can also diagnose the problem by checking the startup print of <code>serial port 0</code>.</p>
<h2 id="Sending-and-Receiving-Data">Sending and Receiving Data</h2>
<p>The <code>write_str</code> function is used to send strings. In Python, there are two fundamental data types, <code>str</code> and <code>bytes</code>, where the former is a string, and the latter is raw byte data, for example:</p>
<ul>
<li><code>&quot;A&quot;</code> becomes <code>b&quot;A&quot;</code> using the <code>encode()</code> method, conversely <code>b&quot;A&quot;</code> becomes <code>&quot;A&quot;</code> using the <code>decode()</code> method.</li>
<li><code>str</code> can't display some invisible characters, like ASCII code value <code>0</code>, represented as <code>\0</code> in strings, generally used as an end character, whereas in <code>bytes</code> type, it can be stored as <code>b&quot;\x00&quot;</code>.</li>
<li>It's even more useful for non-ASCII encoded strings, e.g., the Chinese character <code>好</code> in UTF-8 encoding is represented by three bytes <code>\xe5\xa5\xbd</code>, which can be obtained by <code>&quot;好&quot;.encode(&quot;utf-8&quot;)</code> to produce <code>b&quot;\xe5\xa5\xbd&quot;</code>, or converted back to <code>&quot;好&quot;</code> using <code>b'\xe5\xa5\xbd'.decode(&quot;utf-8)</code>.</li>
</ul>
<p>Thus, if you need to send byte data, use the <code>write()</code> method.</p>
<p>For <code>str</code> type, you can avoid using <code>write_str</code> and instead send using <code>serial.write(str_content.encode())</code>.</p>
<p>Also, if you have a <code>list</code> type of data, you can construct a <code>bytes</code> object using the <code>bytes()</code> method, like:</p>

<pre class="language-python"><code class="language-python">a = [1, 2, 3]
serial.write(bytes(a))
</code></pre>
<p>Similarly, the data obtained by the <code>read</code> method is also of <code>bytes</code> type.</p>
<h2 id="Other-Usage">Other Usage</h2>

<pre class="language-python"><code class="language-python">from maix import app, uart, time
import sys

device = &quot;/dev/ttyS0&quot;

serial0 = uart.UART(device, 115200)

serial0.write(&quot;hello 1\r\n&quot;.encode())
serial0.write_str(&quot;hello 2\r\n&quot;)

while not app.need_exit():
    data = serial0.read()
    if data:
        print(&quot;Received, type: {}, len: {}, data: {}&quot;.format(type(data), len(data), data))
        serial0.write(data)
    time.sleep_ms(1) # sleep 1ms to make CPU free
</code></pre>
<p>Additionally, a `sleep</p>
<p>_ms` is included in the loop as a simple way to release the CPU, aiming to ensure the program does not consume all CPU resources. This is the simplest and most straightforward method.</p>
<h2 id="Using-Other-Serial-Ports">Using Other Serial Ports</h2>
<p>Each pin may correspond to different peripheral functions, also known as pin multiplexing. As shown in the diagram below, each pin corresponds to different functions, for example, pin <code>A17</code> (as labeled on the board) corresponds to <code>GPIOA17</code>, <code>UART0_RX</code>, <code>PWM5</code>, by default set to <code>UART0_RX</code>.</p>
<p><img src="http://wiki.sipeed.com/hardware/zh/lichee/assets/RV_Nano/intro/RV_Nano_3.jpg" alt="" /></p>
<p>Normally, you can directly use <code>UART0</code> as mentioned above. For other serial ports, whose pins are not defaulted to serial peripheral functions, you need to first set up the mapping using <code>pinmap.set_pin_function</code>.</p>
<p>For example, to use <code>UART1</code>, first set the pin function mapping for serial, then use the device number <code>/dev/ttyS1</code>. Note that <code>uart.list_devices()</code> does not by default return serial ports that require manual mapping, so you can manually pass parameters:</p>

<pre class="language-python"><code class="language-python">from maix import app, uart, pinmap, time

pinmap.set_pin_function(&quot;A18&quot;, &quot;UART1_RX&quot;)
pinmap.set_pin_function(&quot;A19&quot;, &quot;UART1_TX&quot;)

device = &quot;/dev/ttyS1&quot;

serial1 = uart.UART(device, 115200)
</code></pre>
<h2 id="Using-Serial-Communication-Protocols">Using Serial Communication Protocols</h2>
<p>With serial communication, you can choose to transmit information in a way that suits your preferences, either by directly sending string results or by using Python's <code>struct</code> library to encode into a binary protocol.</p>
<p>Additionally, MaixPy also has a built-in communication protocol that you can use directly.</p>
<p>This communication protocol specifies the format in which both parties transmit content, facilitating the parsing and recognition of information. It is a binary protocol that includes a frame header, data content, checksum, etc. The complete protocol definition can be found at <a href="https://github.com/sipeed/MaixCDK/blob/master/docs/doc/convention/protocol.md"  target="_blank">Maix Serial Communication Protocol Standard</a>.<br />
It might seem difficult if you have never dealt with communication protocols, but you can understand it after going through the example below several times.</p>
<p>For instance, if we have an object detection task, and we want to send the detected object information via serial port to other devices (like an STM32 or Arduino microcontroller), telling them what objects were detected and their coordinates.</p>
<p>Complete example: <a href="https://github.com/sipeed/MaixPy/tree/main/examples/protocol/comm_protocol_yolov5.py"  target="_blank">MaixPy/examples/protocol/comm_protocol_yolov5.py</a></p>
<p>First, we need to detect the object, refer to the <code>yolov5</code> object detection example, and here we skip other details to focus on what the detection results look like:</p>

<pre class="language-python"><code class="language-python">while not app.need_exit():
    img = cam.read()
    objs = detector.detect(img, conf_th = 0.5, iou_th = 0.45)
    for obj in objs:
        img.draw_rect(obj.x, obj.y, obj.w, obj.h, color = image.COLOR_RED)
        msg = f'{detector.labels[obj.class_id]}: {obj.score:.2f}'
        img.draw_string(obj.x, obj.y, msg, color = image.COLOR_RED)
    dis.show(img)
</code></pre>
<p>As you can see, <code>objs</code> contains multiple detection results, and here we draw boxes on the screen. We can also find a way to send these results via the serial port.<br />
We do not need to manually initialize the serial port, just use the built-in <code>maix.comm, maix.protocol</code> modules, and calling <code>comm.CommProtocol</code> will automatically initialize the serial port with a default baud rate of <code>115200</code>. The serial port protocol settings can be found in the device <code>System Settings-&gt;Communication Protocol</code>.<br />
System settings might also include other communication methods like <code>tcp</code>, the default is <code>uart</code>, and you can also use <code>maix.app.get_sys_config_kv(&quot;comm&quot;, &quot;method&quot;)</code> to check if the current setting is <code>uart</code>.</p>

<pre class="language-python"><code class="language-python">from maix import comm, protocol, app
from maix.err import Err
import struct

def encode_objs(objs):
    '''
        Encode object info into a bytes body for protocol
        2B x(LE) + 2B y(LE) + 2B w(LE) + 2B h(LE) + 2B idx ...
    '''
    body = b&quot;&quot;
    for obj in objs:
        body += struct.pack(&quot;&lt;hhHHH&quot;, obj.x, obj.y, obj.w, obj.h, obj.class_id)
    return body

APP_CMD_ECHO = 0x01
APP_CMD_DETECT_RES = 0x02

p = comm.CommProtocol(buff_size = 1024)

while not app.need_exit():
    # ...
    objs = detector.detect(img, conf_th = 0.5, iou_th = 0.45)
    if len(objs) &gt; 0:
        body = encode_objs(objs)
        p.report(APP_CMD_DETECT_RES, body)
    # ...
</code></pre>
<p>Here, the <code>encode_objs</code> function packages all detected object information into a <code>bytes</code> type of data, and then the <code>p.report</code> function sends the results out.</p>
<p>The content of <code>body</code> is simply defined as <code>2B x(LE) + 2B y(LE) + 2B w(LE) + 2B h(LE) + 2B idx ...</code>,<br />
meaning:</p>
<ul>
<li>Multiple objects detected in this image are arranged in order in <code>body</code>, each target occupies 10 bytes, totaling <code>body_len / 10</code> objects.</li>
<li>The first and second bytes represent the top-left <code>x</code> coordinate of the detected object, measured in pixels. Since the <code>yolov5</code> results might have negative coordinates, we use a <code>short</code> type to represent them, encoded in little-endian (LE).<blockquote>
Here, little-endian means the lower byte comes first, for example, the coordinate <code>x</code> is <code>100</code>, hex <code>0x64</code>, represented by two bytes as <code>short</code> would be <code>0x0064</code>, and little-endian encoded into <code>bytes</code> would be <code>0x64</code> first,resulting in <code>b'\x64\x00'</code>.</blockquote>
</li>
<li>Similarly, encode the subsequent data sequentially, with each object resulting in a <code>10</code>-byte-long <code>bytes</code> type data.</li>
<li>Loop to encode all object information and concatenate into a <code>bytes</code> object.</li>
</ul>
<p>When calling the <code>report</code> function, the underlying system will automatically concatenate protocol headers, checksums, etc., according to the protocol, resulting in a frame of complete data being received at the other end.</p>
<p>After receiving the information at the other end, it must also be decoded according to the protocol. If the receiving end uses MaixPy, you can directly:</p>

<pre class="language-python"><code class="language-python">while not app.need_exit():
    msg = p.get_msg()
    if msg and msg.is_report and msg.cmd == APP_CMD_DETECT_RES:
        print(&quot;receive objs:&quot;, decode_objs(msg.get_body()))
        p.resp_ok(msg.cmd, b'1')
</code></pre>
<p>For other devices such as <code>STM32</code> or <code>Arduino</code>, refer to the C language functions in the appendix of <a href="https://github.com/sipeed/MaixCDK/blob/master/docs/doc/convention/protocol.md"  target="_blank">Maix Serial Communication Protocol Standard</a> for encoding and decoding.</p>

                        
                    </div>
                </div>
                <div id="previous_next">
                    <div id="previous">
                        
                        <a href="/maixpy/doc/en/peripheral/gpio.html">
                            <span class="icon"></span>
                            <span class="label">GPIO</span>
                        </a>
                        
                    </div>
                    <div id="next">
                        
                        <a href="/maixpy/doc/en/peripheral/i2c.html">
                            <span class="label">I2C</span>
                            <span class="icon"></span>
                        </a>
                        
                    </div>
                </div>
                <div id="comments-container"></div>
            </div>
            <div id="toc_wrapper">
                <div id="toc">
                    <div id="toc_content">
                            
                    </div>
                </div>
            </div>
        </div>
    </div>
    <a id="to_top" href="#"></a>
    <div id="doc_footer">
        <div id="footer">
            <div id="footer_top">
                <ul>
<li><a>Links</a><ul><li><a target="_blank" href="https://wiki.sipeed.com">Sipeed Wiki</a></li>
<li><a target="_blank" href="https://www.sipeed.com">Sipeed Official</a></li>
<li><a target="_blank" href="https://maixhub.com/">MaixHub</a></li>
<li><a  href="/maixpy/sitemap.xml">Site map</a></li>
<li><a target="_blank" href="https://github.com/neutree/teedoc">Generated by teedoc</a></li>
</ul>
</li>
<li><a>Source code</a><ul><li><a target="_blank" href="https://github.com/sipeed/maixpy">MaixPy source code</a></li>
<li><a target="_blank" href="https://github.com/sipeed/MaixCDK">MaixCDK source code</a></li>
<li><a target="_blank" href="https://github.com/sipeed/sipeed_wiki">Wiki source code</a></li>
<li><a target="_blank" href="https://github.com/sipeed">Open source projects</a></li>
</ul>
</li>
<li><a>Follow us</a><ul><li><a target="_blank" href="https://twitter.com/SipeedIO">twitter</a></li>
<li><a target="_blank" href="https://sipeed.taobao.com/">Taobao</a></li>
<li><a target="_blank" href="https://www.aliexpress.com/store/911876460">AliExpress</a></li>
<li><a target="_blank" href="https://github.com/sipeed">github</a></li>
<li><a><a>Wechat </a><img src='/maixpy/static/image/wechat.png'></a>
</li>
</ul>
</li>
<li><a>Contact us</a><ul><li><a>Tel: +86 0755-27808509</a>
</li>
<li><a>Bussiness: support@sipeed.com</a>
</li>
<li><a>Addr: 深圳市宝安区新湖路4008号蘅芳科技办公大厦A座-2101C</a>
</li>
<li><a  href="https://wiki.sipeed.com/join_us.html">Join us</a></li>
</ul>
</li>
</ul>

            </div>
            <div id="footer_bottom">
                <ul>
<li><a target="_blank" href="https://www.sipeed.com">©2018-2023 深圳矽速科技有限公司</a></li>
<li><a target="_blank" href="https://beian.miit.gov.cn/#/Integrated/index">粤ICP备19015433号</a></li>
</ul>

            </div>
        </div>
    </div>
    
        <script src="/maixpy/teedoc-plugin-markdown-parser/mermaid.min.js"></script>
    
        <script>mermaid.initialize({startOnLoad:true});</script>
    
        <script src="/maixpy/static/js/theme_default/tocbot.min.js"></script>
    
        <script src="/maixpy/static/js/theme_default/main.js"></script>
    
        <script src="/maixpy/static/js/theme_default/viewer.min.js"></script>
    
        <script src="/maixpy/static/css/theme_default/prism.min.js"></script>
    
        <script src="/maixpy/static/js/search/search_main.js"></script>
    
        <script src="/maixpy/static/js/custom.js"></script>
    
</body>

</html>